/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,a){"use strict";function o(e,t,n){return t<=e.length?e:o(t,n+e,n)}function i(e){var t=new Date(1e3*e),n=o(String(t.getHours()-1),1,"0")+":"+o(String(t.getMinutes()),2,"0")+":"+o(String(t.getSeconds()),2,"0");return n}e.fn.video=function(n){{var o,u=e(this),s=u.selector||"",l=(new Date).getTime(),r=[],c=arguments[0],d="string"==typeof c,m=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return u.each(function(){var p,g=e.isPlainObject(n)?e.extend(!0,{},e.fn.video.settings,n):e.extend({},e.fn.video.settings),f=(g.selector,g.className,g.error,g.metadata,g.namespace),v=(g.templates,"."+f),b="module-"+f,y=(e(t),e(this)),R=y.find(g.selector.video),h=y.find(g.selector.playButton),q=y.find(g.selector.playRateButton),k=y.find(g.selector.currentTime),T=y.find(g.selector.remainingTime),C=y.find(g.selector.timeRange),N=y.find(g.selector.volumeUpButton),B=y.find(g.selector.volumeDownButton),w=y.find(g.selector.volumeProgress),U=y.find(g.selector.muteButton),x=!0,D=C.prop("max")-C.prop("min"),S=this,A=R.get(0),F=y.data(b);p={initialize:function(){p.debug("Initializing video"),p.instantiate(),p.bind.events()},instantiate:function(){p.verbose("Storing instance of module",p),F=p,y.data(b,p)},bind:{events:function(){p.debug("Binding video module events"),R.on("play"+v,p.activate.playButton).on("pause"+v,p.deactivate.playButton).on("ratechange"+v,function(e){console.log(A.playbackRate)}).on("timeupdate"+v,p.update.time).on("loadstart"+v+" seeking"+v,p.update.loading).on("loadeddata"+v+" seeked"+v,p.update.loaded).on("volumechange"+v,p.update.volume),h.on("click"+v,p.request.playToggle),q.on("mousedown"+v,p.request.playRate).on("mouseup"+v,p.reset.playkRate),C.on("change"+v,p.request.seek).on("mousedown"+v,p.deactivate.timeRangeUpdate).on("mouseup"+v,p.activate.timeRangeUpdate),N.on("click"+v,p.request.volumeUp),B.on("click"+v,p.request.volumeDown),w.on("click"+v,p.request.unmute),U.on("click"+v,p.request.muteToggle)}},request:{playToggle:function(){return p.debug("Request play toggle"),A.paused?p.request.play():p.request.pause()},play:function(){return p.debug("Request play"),A.play()},pause:function(){return p.debug("Request pause"),A.pause()},playRate:function(){p.debug("Request playRate from button data"),A.playbackRate=parseFloat(e(this).data("play-rate"))},seek:function(){p.debug("Request seek from range value");var e=C.val()/D,t=A.duration*e;A.fastSeek?A.fastSeek(t):A.currentTime=t},volumeUp:function(){p.debug("Request volume up"),e(this).hasClass(g.className.disabled)?A.muted=!1:A.volume=Math.min(A.volume+g.volumeStep,1)},volumeDown:function(){p.debug("Request volume down"),e(this).hasClass(g.className.disabled)?A.muted=!1:A.volume=Math.max(A.volume-g.volumeStep,0)},mute:function(){p.debug("Request mute"),A.muted=!0},unmute:function(){p.debug("Request unmute"),A.muted=!1},muteToggle:function(){p.debug("Request mute toggle"),A.muted=!A.muted}},reset:{playRate:function(){p.debug("Reset play rate"),A.playbackRate=A.defaultPlaybackRate}},update:{time:function(){p.debug("Update time"),k.text(i(A.currentTime)),T.text(i(A.duration-A.currentTime)),x&&C.val(D*A.currentTime/A.duration)},loading:function(){p.debug("Update to loading state"),C.prop("disabled",!0).addClass(g.className.disabled)},loaded:function(){p.debug("Update to loaded state"),C.prop("disabled",!1).removeClass(g.className.disabled)},volume:function(){p.debug("Update volume and mute states"),A.muted?(N.addClass(g.className.disabled),B.addClass(g.className.disabled),w.addClass(g.className.disabled),U.addClass(g.className.active)):(N.removeClass(g.className.disabled),B.removeClass(g.className.disabled),w.removeClass(g.className.disabled),U.removeClass(g.className.active));var e=A.muted?0:A.volume;w.progress({percent:100*e})}},activate:{playButton:function(){p.debug("Activate playButton"),h.addClass(g.className.active)},timeRangeUpdate:function(){p.debug("Activate timeRange autoupdate"),x=!0}},deactivate:{playButton:function(){p.debug("Deactivate playButton"),h.removeClass(g.className.active)},timeRangeUpdate:function(){p.debug("Deactivate timeRange autoupdate"),x=!1}},destroy:function(){p.verbose("Destroying previous instance of video"),R=null,p.reset(),y.removeData(b).off(v)},refresh:function(){p.verbose("Refreshing selector cache"),R=S},reset:function(){p.debug("Clearing video"),g.onReset()},setting:function(t,n){if(p.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,g,t);else{if(n===a)return g[t];g[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(n===a)return p[t];p[t]=n}},debug:function(){g.debug&&(g.performance?p.performance.log(arguments):(p.debug=Function.prototype.bind.call(console.info,console,g.name+":"),p.debug.apply(console,arguments)))},verbose:function(){g.verbose&&g.debug&&(g.performance?p.performance.log(arguments):(p.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),p.verbose.apply(console,arguments)))},error:function(){p.error=Function.prototype.bind.call(console.error,console,g.name+":"),p.error.apply(console,arguments)},performance:{log:function(e){var t,n,a;g.performance&&(t=(new Date).getTime(),a=l||t,n=t-a,l=t,r.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:S,"Execution Time":n})),clearTimeout(p.performance.timer),p.performance.timer=setTimeout(p.performance.display,500)},display:function(){var t=g.name+":",n=0;l=!1,clearTimeout(p.performance.timer),e.each(r,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",s&&(t+=" '"+s+"'"),u.length>1&&(t+=" ("+u.length+")"),(console.group!==a||console.table!==a)&&r.length>0&&(console.groupCollapsed(t),console.table?console.table(r):e.each(r,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),r=[]}},invoke:function(t,n,i){var u,s,l,r=F;return n=n||m,i=S||i,"string"==typeof t&&r!==a&&(t=t.split(/[\. ]/),u=t.length-1,e.each(t,function(n,o){var i=n!=u?o+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(r[i])&&n!=u)r=r[i];else{if(r[i]!==a)return s=r[i],!1;if(!e.isPlainObject(r[o])||n==u)return r[o]!==a?(s=r[o],!1):(p.error(t),!1);r=r[o]}})),e.isFunction(s)?l=s.apply(i,n):s!==a&&(l=s),e.isArray(o)?o.push(l):o!==a?o=[o,l]:l!==a&&(o=l),s}},d?(F===a&&p.initialize(),p.invoke(c)):(F!==a&&F.invoke("destroy"),p.initialize())}),o!==a?o:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!0,performance:!0,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",playRateButton:".playrate.button[data-play-rate]",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeUpButton:".volume.up.button",volumeDownButton:".volume.down.button",volumeProgress:".volume.progress",muteButton:".mute.button"},volumeStep:.1}}(jQuery,window,document);