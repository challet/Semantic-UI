/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,a){"use strict";function o(e,t,n){return t<=e.length?e:o(t,n+e,n)}function u(e,t){for(var n=0;n<t.length;n++)if(e>=t.start(n)&&e<=t.end(n))return!0;return!1}function i(e){var t=new Date(1e3*e),n=o(String(t.getHours()-1),1,"0")+":"+o(String(t.getMinutes()),2,"0")+":"+o(String(t.getSeconds()),2,"0");return n}function r(t){t.preventDefault(),e(this).blur()}function s(e,t){for(var n=[];e.length>0;)n.push(e.pop()+t);return n.join(" ")}e.fn.video=function(n){{var o,l=e(this),c=l.selector||"",d=(new Date).getTime(),p=[],m=arguments[0],g="string"==typeof m,f=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return l.each(function(){var b,k=e.isPlainObject(n)?e.extend(!0,{},e.fn.video.settings,n):e.extend({},e.fn.video.settings),v=(k.selector,k.className,k.error,k.metadata,k.namespace),y=(k.templates,"."+v),h="module-"+v,R=(e(t),e(this)),T=R.find(k.selector.video),A=R.find(k.selector.playButton),E=R.find(k.selector.seekButton),S=R.find(k.selector.currentTime),N=R.find(k.selector.remainingTime),_=R.find(k.selector.timeRange),D=R.find(k.selector.volumeUpButton),q=R.find(k.selector.volumeDownButton),O=R.find(k.selector.volumeProgress),w=R.find(k.selector.muteButton),x=R.find(k.selector.rateInput),U=R.find(k.selector.rateReset),C=R.find(k.selector.readyStateRadio),V=R.find(k.selector.networkStateRadio),H=R.find(k.selector.statesLabel),G=R.find(k.selector.bufferCheckbox),P=R.find(k.selector.seekableCheckbox),I=R.find(k.selector.playedCheckbox),L=R.find(k.selector.seekingStateCheckbox),B=R.find(k.selector.seekingStateDimmer),F=_.parent(".ui.input"),K=R.find(k.selector.timeLookupValue),W=!0,M=_.prop("max")-_.prop("min"),j=a,z=t.setTimeout(1,function(){}),Y=this,Q=T.get(0),J=R.data(h);b={initialize:function(){b.debug("Initializing video"),b.instantiate(),b.bind.pushes(),b.bind.popups(),b.bind.events(),b.initialValues()},instantiate:function(){b.verbose("Storing instance of module",b),J=b,R.data(h,b)},bind:{pushes:function(){E.push({onStart:b.activate.holdPlayState,onStop:b.deactivate.holdPlayState}),D.push(),q.push()},popups:function(){F.popup({popup:R.find(k.selector.timeLookupPopup),position:"top center",on:"manual",preserve:!0})},events:function(){b.debug("Binding video module events"),T.on(s(["play","playing","pause","ended"],y),b.update.playState).on(s(["ratechange"],y),b.update.rate).on(s(["timeupdate"],y),b.update.time).on(s(["seeking"],y),b.update.seeking).on(s(["seeked"],y),b.update.seeked).on(s(["volumechange"],y),b.update.volume).on(s(["canplaythrough","canplay","loadeddata","emptied","waiting"],y),b.update.readyState).on(s(["error","loadstart","emptied","stalled","suspend","waiting","loadedmetadata","loadeddata"],y),b.update.networkState),A.on(s(["click"],y),b.request.playToggle),E.on(s(["click"],y),b.request.seek.toRelativeTime),_.on(s(["mousedown"],y),b.activate.timeLookup).on(s(["mouseup"],y),b.deactivate.timeLookup).on(s(["input"],y),b.update.timeLookup).on(s(["change"],y),b.request.seek.fromRangeValue),D.on(s(["click"],y),b.request.volumeUp),q.on(s(["click"],y),b.request.volumeDown),O.on(s(["click"],y),b.request.unmute),w.on(s(["click"],y),b.request.muteToggle),x.on(s(["change"],y),b.request.rate),U.on(s(["click"],y),b.reset.rate),C.on(s(["click"],y),b.request.denied),V.on(s(["click"],y),r),H.on(s(["click"],y),r)}},initialValues:function(){b.update.playState(),b.update.volume()},get:{pausedState:function(){return b.debug("Get paused state"),T.prop("paused")},endedState:function(){return b.debug("Get ended state"),T.prop("ended")},currentTime:function(){return b.debug("Get current time value"),T.prop("currentTime")},duration:function(){return b.debug("Get duration value"),T.prop("duration")},bufferedRanges:function(){return b.debug("Get buffered ranges"),T.prop("buffered")},seekableRanges:function(){return b.debug("Get seekable ranges"),T.prop("seekable")},playedRanges:function(){return b.debug("Get played ranges"),T.prop("played")},volume:function(){return b.debug("Get volume value"),T.prop("volume")},playbackRate:function(){return b.debug("Get playback rate value"),T.prop("playbackRate")},readyState:function(){switch(b.debug("Get ready state value"),T.prop("readyState")){default:case R.prop("HAVE_NOTHING"):return k.constants.HAVE_NOTHING;case T.prop("HAVE_METADATA"):return k.constants.HAVE_METADATA;case T.prop("HAVE_CURRENT_DATA"):return k.constants.HAVE_CURRENT_DATA;case T.prop("HAVE_FUTURE_DATA"):return k.constants.HAVE_FUTURE_DATA;case T.prop("HAVE_ENOUGH_DATA"):return k.constants.HAVE_ENOUGH_DATA}},networkState:function(){switch(b.debug("Get network state value"),R.prop("neworkState")){default:case R.prop("NETWORK_EMPTY"):return k.constants.NETWORK_EMPTY;case T.prop("NETWORK_IDLE"):return k.constants.NETWORK_IDLE;case T.prop("NETWORK_LOADING"):return k.constants.NETWORK_LOADING;case T.prop("NETWORK_NO_SOURCE"):return k.constants.NETWORK_NO_SOURCE}},timeRangeValue:function(){return b.get.duration()*_.val()/M}},is:{playing:function(){return b.debug("Is playing"),!b.get.pausedState()&&!b.get.endedState()},seeking:function(){return b.debug("Is seeking"),T.prop("seeking")},muted:function(){return b.debug("Is muted"),T.prop("muted")},timeBuffered:function(e){return b.debug("Is timeBuffered"),u(e,b.get.bufferedRanges())},timePlayed:function(e){return b.debug("Is timePlayed"),u(e,b.get.playedRanges())},timeSeekable:function(e){return b.debug("Is timeSeekable"),u(e,b.get.seekableRanges())}},update:{playState:function(){b.debug("Update play state"),b.is.playing()?A.addClass(k.className.active):A.removeClass(k.className.active)},time:function(){var e=b.get.currentTime(),t=b.get.duration();b.debug("Update time"),S.text(i(e)),N.text(i(t-e)),console.log(W),W&&_.val(M*e/t)},seeking:function(){b.debug("Update seek state (seeking)"),t.clearTimeout(z),L.prop("checked",!0),B.dimmer("show")},seeked:function(e){b.debug("Update seek state (seeked)"),e!==a?z=t.setTimeout(b.update.seeked,k.seekedDelay):(L.prop("checked",!1),B.dimmer("hide"))},volume:function(){var e=b.is.muted(),t=b.get.volume();b.debug("Update volume and mute states"),e?(D.addClass(k.className.disabled),q.addClass(k.className.disabled),O.addClass(k.className.disabled),w.addClass(k.className.active)):(D.removeClass(k.className.disabled),q.removeClass(k.className.disabled),O.removeClass(k.className.disabled),w.removeClass(k.className.active)),O.progress({percent:100*t})},rate:function(){b.debug("Update playBack rate"),x.val(b.get.playbackRate())},readyState:function(){b.debug("Update ready state"),C.filter("[value="+b.get.readyState()+"]").prop("checked",!0)},networkState:function(){b.debug("Update network state"),V.filter("[value="+b.get.networkState()+"]").prop("checked",!0)},timeLookup:function(e){b.debug("Update timelookup state");var t=b.get.timeRangeValue();G.prop("checked",b.is.timeBuffered(t)),P.prop("checked",b.is.timeSeekable(t)),I.prop("checked",b.is.timePlayed(t)),K.text(i(t))}},request:{play:function(){b.debug("Request play"),Q.play()},pause:function(){b.debug("Request pause"),Q.pause()},playToggle:function(){b.debug("Request play toggle"),b.is.playing()?Q.pause():Q.play()},rate:function(){b.debug("Request playback rate (from button data)"),Q.playbackRate=parseFloat(e(this).val())},seek:{toAbsoluteTime:function(e){b.debug("Request time absolute seek"),Q.fastSeek?Q.fastSeek(e):Q.currentTime=e},toRelativeTime:function(){b.debug("Request time relative seek from current position)");var t=b.get.currentTime()+e(this).data("seek-step");b.request.seek.toAbsoluteTime(t)},fromRangeValue:function(){b.debug("Request time seek from absolute range value"),b.request.seek.toAbsoluteTime(b.get.timeRangeValue())}},volumeUp:function(){Q.muted?b.request.unmute():(b.debug("Request volume up"),Q.volume=Math.min(Q.volume+e(this).data("volume-step"),1))},volumeDown:function(){Q.muted?b.request.unmute():(b.debug("Request volume down"),Q.volume=Math.max(Q.volume-e(this).data("volume-step"),0))},mute:function(){b.debug("Request mute"),Q.muted=!0},unmute:function(){b.debug("Request unmute"),Q.muted=!1},muteToggle:function(){b.debug("Request mute toggle"),Q.muted=!Q.muted},denied:function(e){b.debug("Requet denied"),e.preventDefault()}},activate:{holdPlayState:function(){b.debug("Hold play state (while an other operation is occuring)"),j=b.is.playing(),b.request.pause()},timeLookup:function(){b.debug("Activate time lookup"),F.popup("show"),W=!1}},deactivate:{holdPlayState:function(){b.debug("Unhold play state (after an other operation has occured)"),j&&b.request.play(),j=a},timeLookup:function(){b.debug("Deactivate time lookup"),F.popup("hide"),W=!0}},reset:{rate:function(){b.debug("Reset playBack rate"),Q.playbackRate=Q.defaultPlaybackRate},all:function(){b.debug("Clearing video"),k.onReset()}},destroy:function(){b.verbose("Destroying previous instance of video"),T=null,b.reset(),R.removeData(h).off(y)},refresh:function(){b.verbose("Refreshing selector cache"),T=Y},setting:function(t,n){if(b.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,k,t);else{if(n===a)return k[t];k[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,b,t);else{if(n===a)return b[t];b[t]=n}},debug:function(){k.debug&&(k.performance?b.performance.log(arguments):(b.debug=Function.prototype.bind.call(console.info,console,k.name+":"),b.debug.apply(console,arguments)))},verbose:function(){k.verbose&&k.debug&&(k.performance?b.performance.log(arguments):(b.verbose=Function.prototype.bind.call(console.info,console,k.name+":"),b.verbose.apply(console,arguments)))},error:function(){b.error=Function.prototype.bind.call(console.error,console,k.name+":"),b.error.apply(console,arguments)},performance:{log:function(e){var t,n,a;k.performance&&(t=(new Date).getTime(),a=d||t,n=t-a,d=t,p.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:Y,"Execution Time":n})),clearTimeout(b.performance.timer),b.performance.timer=setTimeout(b.performance.display,500)},display:function(){var t=k.name+":",n=0;d=!1,clearTimeout(b.performance.timer),e.each(p,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",c&&(t+=" '"+c+"'"),l.length>1&&(t+=" ("+l.length+")"),(console.group!==a||console.table!==a)&&p.length>0&&(console.groupCollapsed(t),console.table?console.table(p):e.each(p,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),p=[]},invoke:function(t,n,u){var i,r,s,l=J;return n=n||f,u=Y||u,"string"==typeof t&&l!==a&&(t=t.split(/[\. ]/),i=t.length-1,e.each(t,function(n,o){var u=n!=i?o+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(l[u])&&n!=i)l=l[u];else{if(l[u]!==a)return r=l[u],!1;if(!e.isPlainObject(l[o])||n==i)return l[o]!==a?(r=l[o],!1):(b.error(t),!1);l=l[o]}})),e.isFunction(r)?s=r.apply(u,n):r!==a&&(s=r),e.isArray(o)?o.push(s):o!==a?o=[o,s]:s!==a&&(o=s),r}}},g?(J===a&&b.initialize(),b.invoke(m)):(J!==a&&J.invoke("destroy"),b.initialize())}),o!==a?o:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!1,performance:!1,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",seekButton:".seek.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeUpButton:".volume.up.button",volumeDownButton:".volume.down.button",volumeProgress:".volume.progress",muteButton:".mute.button",rateInput:'.rate input[type="number"]',rateReset:".rate .reset",seekingStateCheckbox:'.seeking.checkbox input[type="checkbox"]',seekingStateDimmer:".seeking.dimmer",readyStateRadio:'.ready.state input[type="radio"]',networkStateRadio:'.network.state input[type="radio"]',bufferCheckbox:'.buffer.checkbox input[type="checkbox"]',seekableCheckbox:'.seekable.checkbox input[type="checkbox"]',playedCheckbox:'.played.checkbox input[type="checkbox"]',statesLabel:".ready.state label, .network.state label, .buffer.checkbox label, .seekable.checkbox label, .played.checkbox label",timeLookupPopup:".timelookup.popup",timeLookupValue:".timelookup.popup .time"},constants:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4,NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3},volumeStep:.1,seekedDelay:250}}(jQuery,window,document);