/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,n,t,o){"use strict";function a(e,n,t){return n<=e.length?e:a(n,t+e,t)}function i(e,n){for(var t=0;t<n.length;t++)if(e>=n.start(t)&&e<=n.end(t))return!0;return!1}e.fn.video=function(t){{var s,r=e(this),u=r.selector||"",c=(new Date).getTime(),l=[],d=arguments[0],m="string"==typeof d,f=[].slice.call(arguments,1);n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return r.each(function(){var v,g=e.isPlainObject(t)?e.extend(!0,{},e.fn.video.settings,t):e.extend({},e.fn.video.settings),p=(g.selector,g.className,g.error,g.metadata,g.namespace),b=(g.templates,"."+p),h="module-"+p,y=(e(n),e(this)),w=y.find(g.selector.video),k=y.find(g.selector.playButton),T=(y.find(g.selector.backwardButton),y.find(g.selector.forwardButton)),C=y.find(g.selector.currentTime),N=y.find(g.selector.remainingTime),B=y.find(g.selector.timeRange),R=y.find(g.selector.volumeUpButton),x=y.find(g.selector.volumeDownButton),S=y.find(g.selector.volumeProgress),A=y.find(g.selector.muteButton),D=this,F=w.get(0),P=y.data(h);v={initialize:function(){v.debug("Initializing video"),v.instantiate()},instantiate:function(){v.verbose("Storing instance of module",v),P=v,y.data(h,v),v.debug("Add controls"),y.video("add play button"),y.video("add forward button"),y.video("add current time"),y.video("add remaining time"),y.video("add time range"),y.video("add volume up button"),y.video("add volume down button"),y.video("add volume progress "),y.video("add mute button")},add:{playButton:function(){k.on("click"+b,function(){F.paused?F.play():F.pause()}),w.on("play"+b,function(){k.addClass(g.className.active)}).on("pause"+b,function(){k.removeClass(g.className.active)})},forwardButton:function(){T.on("mousedown"+b,function(){F.playbackRate=g.backwardRate}),T.on("mouseup"+b+" mouseleave"+b,function(){F.playbackRate=F.defaultPlaybackRate}),w.on("ratechange"+b,function(e){console.log(F.playbackRate)})},currentTime:function(){w.on("timeupdate"+b,function(){var e=new Date(1e3*F.currentTime),n=a(String(e.getHours()-1),1,"0")+":"+a(String(e.getMinutes()),2,"0")+":"+a(String(e.getSeconds()),2,"0");C.text(n)})},remainingTime:function(){w.on("timeupdate"+b,function(){var e=new Date(1e3*(F.duration-F.currentTime)),n=a(String(e.getHours()-1),1,"0")+":"+a(String(e.getMinutes()),2,"0")+":"+a(String(e.getSeconds()),2,"0");N.text(n)})},timeRange:function(){var e=!0,n=B.prop("max")-B.prop("min");B.on("change",function(e){var t=B.val()/n;F.fastSeek?F.fastSeek(F.duration*t):F.currentTime=F.duration*t}).on("mousedown"+b,function(){e=!1}).on("mouseup"+b,function(){e=!0}),w.on("timeupdate"+b,function(){if(e){var t=F.currentTime/F.duration,o=t*n;B.val(o)}}).on("loadstart"+b+" seeking"+b,function(){i(F.currentTime,F.buffered)||B.prop("disabled",!0).addClass(g.className.disabled)}).on("loadeddata"+b+" seeked"+b,function(){B.prop("disabled",!1).removeClass(g.className.disabled)})},volume:{upButton:function(){R.on("click"+b,function(){F.volume=Math.min(F.volume+g.volume_step,1),e(this).hasClass(g.className.disabled)&&F.muted&&(F.muted=!1)}),w.on("volumechange"+b,function(){F.muted?R.addClass(g.className.disabled):R.removeClass(g.className.disabled)})},downButton:function(){x.on("click"+b,function(){F.volume=Math.max(F.volume-g.volume_step,0),e(this).hasClass(g.className.disabled)&&F.muted&&(F.muted=!1)}),w.on("volumechange"+b,function(){F.muted?x.addClass(g.className.disabled):x.removeClass(g.className.disabled)})},progress:function(){S.progress({percent:100}),S.on("click"+b,function(){e(this).hasClass(g.className.disabled)&&F.muted&&(F.muted=!1)}),w.on("volumechange"+b,function(){var e=F.muted?0:F.volume;S.progress({percent:100*e}),F.muted?S.addClass(g.className.disabled):S.removeClass(g.className.disabled)})}},muteButton:function(e){A.on("click"+b,function(){F.muted=!F.muted}),w.on("volumechange"+b,function(){D.muted?A.addClass(g.className.active):A.removeClass(g.className.active)})}},destroy:function(){v.verbose("Destroying previous instance of video"),w=null,v.reset(),y.removeData(h).off(b)},refresh:function(){v.verbose("Refreshing selector cache"),w=D},reset:function(){v.debug("Clearing video"),g.onReset()},setting:function(n,t){if(v.debug("Changing setting",n,t),e.isPlainObject(n))e.extend(!0,g,n);else{if(t===o)return g[n];g[n]=t}},internal:function(n,t){if(e.isPlainObject(n))e.extend(!0,v,n);else{if(t===o)return v[n];v[n]=t}},debug:function(){g.debug&&(g.performance?v.performance.log(arguments):(v.debug=Function.prototype.bind.call(console.info,console,g.name+":"),v.debug.apply(console,arguments)))},verbose:function(){g.verbose&&g.debug&&(g.performance?v.performance.log(arguments):(v.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),v.verbose.apply(console,arguments)))},error:function(){v.error=Function.prototype.bind.call(console.error,console,g.name+":"),v.error.apply(console,arguments)},performance:{log:function(e){var n,t,o;g.performance&&(n=(new Date).getTime(),o=c||n,t=n-o,c=n,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:D,"Execution Time":t})),clearTimeout(v.performance.timer),v.performance.timer=setTimeout(v.performance.display,500)},display:function(){var n=g.name+":",t=0;c=!1,clearTimeout(v.performance.timer),e.each(l,function(e,n){t+=n["Execution Time"]}),n+=" "+t+"ms",u&&(n+=" '"+u+"'"),r.length>1&&(n+=" ("+r.length+")"),(console.group!==o||console.table!==o)&&l.length>0&&(console.groupCollapsed(n),console.table?console.table(l):e.each(l,function(e,n){console.log(n.Name+": "+n["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(n,t,a){var i,r,u,c=P;return t=t||f,a=D||a,"string"==typeof n&&c!==o&&(n=n.split(/[\. ]/),i=n.length-1,e.each(n,function(t,a){var s=t!=i?a+n[t+1].charAt(0).toUpperCase()+n[t+1].slice(1):n;if(e.isPlainObject(c[s])&&t!=i)c=c[s];else{if(c[s]!==o)return r=c[s],!1;if(!e.isPlainObject(c[a])||t==i)return c[a]!==o?(r=c[a],!1):(v.error(n),!1);c=c[a]}})),e.isFunction(r)?u=r.apply(a,t):r!==o&&(u=r),e.isArray(s)?s.push(u):s!==o?s=[s,u]:u!==o&&(s=u),r}},m?(P===o&&v.initialize(),v.invoke(d)):(P!==o&&P.invoke("destroy"),v.initialize())}),s!==o?s:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!0,performance:!0,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",backwardButton:".backward.button",forwardButton:".forward.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeUpButton:".volume.up.button",volumeDownButton:".volume.down.button",volumeProgress:".volume.progress",muteButton:".mute.button"},backwardRate:6,forwardRate:-4,volume_step:.1}}(jQuery,window,document);