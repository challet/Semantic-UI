/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,a,n){"use strict";e.fn.video=function(a){{var o,i=e(this),r=i.selector||"",u=(new Date).getTime(),s=[],l=arguments[0],c="string"==typeof l,d=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return i.each(function(){var p,m=e.isPlainObject(a)?e.extend(!0,{},e.fn.video.settings,a):e.extend({},e.fn.video.settings),f=(m.selector,m.className,m.error,m.metadata,m.namespace),g=(m.templates,"."+f),b="module-"+f,v=(e(t),e(this)),k=v.find(m.selector.video),y=v.find(m.selector.playButton),T=v.find(m.selector.seekButton),R=v.find(m.selector.currentTime),h=v.find(m.selector.remainingTime),A=v.find(m.selector.timeRange),E=v.find(m.selector.volumeChangeButton),S=v.find(m.selector.volumeProgress),N=v.find(m.selector.muteButton),_=v.find(m.selector.rateInput),q=v.find(m.selector.rateReset),O=v.find(m.selector.readyStateRadio),D=v.find(m.selector.networkStateRadio),w=v.find(m.selector.statesLabel),U=v.find(m.selector.timeLookupBuffer),V=v.find(m.selector.timeLookupPlayed),L=(v.find(m.selector.seekingStateCheckbox),v.find(m.selector.loaderDimmer)),H=v.find(m.selector.timeLookupValue),x=v.find(m.selector.sourcePicker),C=!0,P=A.prop("max")-A.prop("min"),I=n,B=t.setTimeout(1,function(){}),F=this,K=k.get(0),W=v.data(b);p={initialize:function(){p.debug("Initializing video"),p.instantiate(),p.bind.events(),p.initialValues()},instantiate:function(){p.verbose("Storing instance of module",p),W=p,v.data(b,p)},bind:{events:function(){p.debug("Binding video module events"),k.on("play"+g+" playing"+g+" pause"+g+" ended"+g,p.update.playState).on("canplaythrough"+g+" canplay"+g+" loadeddata"+g+" emptied"+g+" waiting"+g,p.update.readyState).on("error"+g+" loadstart"+g+" loadedmetadata"+g+" loadeddata"+g+" stalled"+g+" suspend"+g+" emptied"+g+" waiting"+g,p.update.networkState).on("ratechange"+g,p.update.rate).on("timeupdate"+g,p.update.time).on("seeking"+g,p.activate.loader).on("seeked"+g,p.deactivate.loader).on("volumechange"+g,p.update.volume).on("emptied"+g,function(){p.reset.time(),p.activate.loader(),p.deactivate.timeRange()}).on("loadedmetadata"+g+" loadeddata"+g,function(){p.update.time(),p.deactivate.loader(),p.activate.timeRange()}),y.on("click"+g,p.request.playToggle),T.on("click"+g,p.request.seek.toRelativeTime),A.on("mousedown"+g,p.activate.timeLookup).on("mouseup"+g,p.deactivate.timeLookup).on("input"+g,p.update.timeLookup).on("change"+g,p.request.seek.fromRangeValue),E.on("click"+g,p.request.volume.shift),S.on("click"+g,p.request.unmute),N.on("click"+g,p.request.muteToggle),_.on("change"+g,p.request.rate),q.on("click"+g,p.reset.rate),O.on("click"+g,p.request["void"]),D.on("click"+g,p.request["void"]),w.on("click"+g,p.request["void"]),x.on("change"+g,p.request.source)}},initialValues:function(){p.update.playState(),p.update.time(),p.update.volume(),p.update.rate(),p.update.readyState(),p.update.networkState()},get:{pausedState:function(){return k.prop("paused")},endedState:function(){return k.prop("ended")},currentTime:function(){return k.prop("currentTime")},duration:function(){return k.prop("duration")},bufferedRanges:function(){return k.prop("buffered")},seekableRanges:function(){return k.prop("seekable")},playedRanges:function(){return k.prop("played")},volume:function(){return k.prop("volume")},playbackRate:function(){return k.prop("playbackRate")},readyState:function(){var e;switch(k.prop("readyState")){default:case k.prop("HAVE_NOTHING"):e=m.constants.HAVE_NOTHING;break;case k.prop("HAVE_METADATA"):e=m.constants.HAVE_METADATA;break;case k.prop("HAVE_CURRENT_DATA"):e=m.constants.HAVE_CURRENT_DATA;break;case k.prop("HAVE_FUTURE_DATA"):e=m.constants.HAVE_FUTURE_DATA;break;case k.prop("HAVE_ENOUGH_DATA"):e=m.constants.HAVE_ENOUGH_DATA}return e},networkState:function(){var e;switch(k.prop("networkState")){default:case k.prop("NETWORK_EMPTY"):e=m.constants.NETWORK_EMPTY;break;case k.prop("NETWORK_IDLE"):e=m.constants.NETWORK_IDLE;break;case k.prop("NETWORK_LOADING"):e=m.constants.NETWORK_LOADING;break;case k.prop("NETWORK_NO_SOURCE"):e=m.constants.NETWORK_NO_SOURCE}return e},timeRangeValue:function(){return p.get.duration()*A.val()/P},readableTime:function(e){var t=function(e,a,n){return a<=e.length?e:t(a,n+e,n)},a=new Date(1e3*e),n=t(String(a.getHours()-1),1,"0")+":"+t(String(a.getMinutes()),2,"0")+":"+t(String(a.getSeconds()),2,"0");return n}},is:{playing:function(){return!p.get.pausedState()&&!p.get.endedState()},seeking:function(){return k.prop("seeking")},muted:function(){return k.prop("muted")},timeBuffered:function(e){return p.is.timeInRange(e,p.get.bufferedRanges())},timePlayed:function(e){return p.is.timeInRange(e,p.get.playedRanges())},timeSeekable:function(e){return p.is.timeInRange(e,p.get.seekableRanges())},timeInRange:function(e,t){for(var a=0;a<t.length;a++)if(e>=t.start(a)&&e<=t.end(a))return!0;return!1},formatSupported:function(e){var t;switch(console.log(K.canPlayType(e)),K.canPlayType(e)){case"probably":case"maybe":t=!0;break;default:t=!1}return t}},update:{playState:function(){var e=p.is.playing();p.debug("Update play state",e),e?y.addClass(m.className.active):y.removeClass(m.className.active)},time:function(){var e=p.get.currentTime(),t=p.get.duration();isNaN(t)?p.reset.time():(p.debug("Update time",e),R.text(p.get.readableTime(e)),h.text(p.get.readableTime(t-e)),C&&A.val(P*e/t))},volume:function(){var e=p.is.muted(),t=p.get.volume();p.debug("Update volume and mute states",t,e),e?(E.addClass(m.className.disabled),S.addClass(m.className.disabled),N.addClass(m.className.active)):(E.removeClass(m.className.disabled),S.removeClass(m.className.disabled),N.removeClass(m.className.active)),S.progress({percent:100*t})},rate:function(){var e=p.get.playbackRate();p.debug("Update playBack rate",e),_.val(e)},readyState:function(){var e=p.get.readyState();p.debug("Update ready state",e),O.filter("[value="+e+"]").prop("checked",!0)},networkState:function(){var e=p.get.networkState();p.debug("Update network state",e),D.filter("[value="+e+"]").prop("checked",!0)},timeLookup:function(e){var t=p.get.timeRangeValue();p.debug("Update timelookup state",t),U.prop("checked",p.is.timeBuffered(t)),V.prop("checked",p.is.timePlayed(t)),H.text(p.get.readableTime(t))}},request:{play:function(){p.debug("Request play"),K.play()},pause:function(){p.debug("Request pause"),K.pause()},playToggle:function(){p.is.playing()?K.pause():K.play()},rate:function(t){"number"!=typeof t&&(t=parseFloat(e(this).val())),p.debug("Request playback rate",t),K.playbackRate=t},seek:{toAbsoluteTime:function(e){p.is.timeSeekable(e)?(p.debug("Request seek",e),K.fastSeek?K.fastSeek(e):K.currentTime=e):p.debug("Time out of seekable ranges",e)},toRelativeTime:function(t){"number"!=typeof t&&(t=parseFloat(e(this).data(m.matadata.seekStep)));var a=p.get.currentTime()+t;p.request.seek.toAbsoluteTime(a)},fromRangeValue:function(){p.request.seek.toAbsoluteTime(p.get.timeRangeValue())}},volume:{value:function(e){p.debug("Request volume value",e),e=Math.min(e,1),e=Math.max(e,0),K.volume=e},shift:function(t){"number"!=typeof t&&(t=parseFloat(e(this).data(m.matadata.volumeStep))),p.request.volume.value(p.get.volume()+t)}},mute:function(){p.debug("Request mute"),K.muted=!0},unmute:function(){p.debug("Request unmute"),K.muted=!1},muteToggle:function(){p.is.muted()?p.request.unmute():p.request.mute()},"void":function(t){t.preventDefault(),e(this).blur()},source:function(t,a){"string"!=typeof t&&(t=e(this).dropdown("get value")),"string"!=typeof a&&(a=e(this).find('select option[value="'+t+'"]').data("video-type")),p.is.formatSupported(a)?(p.debug("Request source",t),k.empty().append(e("<source>",{src:t,type:a})),K.load()):p.error("Request unsupported type",a,t)}},activate:{holdPlayState:function(){I=p.is.playing(),p.debug("Hold play state",I),p.request.pause()},timeRange:function(){p.debug("Enable timerange"),A.prop("disabled",!1)},timeLookup:function(){m.onTimeLookupStart(),C=!1},loader:function(){p.debug("Activate loader"),t.clearTimeout(B),L.dimmer("show")}},deactivate:{holdPlayState:function(){p.debug("Unhold play state",I),I&&p.request.play(),I=n},timeLookup:function(){m.onTimeLookupStop(),C=!0},timeRange:function(){p.debug("Disable timerange"),A.prop("disabled",!0)},loader:function(e){e!==n?B=t.setTimeout(p.update.seeked,m.seekedDelay):(p.debug("Unactivate loader"),L.dimmer("hide"))}},reset:{rate:function(){var e=K.defaultPlaybackRate;p.debug("Reset playBack rate",e),K.playbackRate=e},source:function(){p.debug("Reset (empty) source"),k.empty(),K.load()},time:function(){p.debug("Reset time"),R.add(h).text(m.timeResetText)},all:function(){p.debug("Clearing video"),m.onReset()}},destroy:function(){p.verbose("Destroying previous instance of video"),k=null,p.reset.all(),v.removeData(b).off(g)},refresh:function(){p.verbose("Refreshing selector cache"),k=F},setting:function(t,a){if(p.debug("Changing setting",t,a),e.isPlainObject(t))e.extend(!0,m,t);else{if(a===n)return m[t];m[t]=a}},internal:function(t,a){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(a===n)return p[t];p[t]=a}},debug:function(){m.debug&&(m.performance?p.performance.log(arguments):(p.debug=Function.prototype.bind.call(console.info,console,m.name+":"),p.debug.apply(console,arguments)))},verbose:function(){m.verbose&&m.debug&&(m.performance?p.performance.log(arguments):(p.verbose=Function.prototype.bind.call(console.info,console,m.name+":"),p.verbose.apply(console,arguments)))},error:function(){p.error=Function.prototype.bind.call(console.error,console,m.name+":"),p.error.apply(console,arguments)},performance:{log:function(e){var t,a,n;m.performance&&(t=(new Date).getTime(),n=u||t,a=t-n,u=t,s.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:F,"Execution Time":a})),clearTimeout(p.performance.timer),p.performance.timer=setTimeout(p.performance.display,500)},display:function(){var t=m.name+":",a=0;u=!1,clearTimeout(p.performance.timer),e.each(s,function(e,t){a+=t["Execution Time"]}),t+=" "+a+"ms",r&&(t+=" '"+r+"'"),i.length>1&&(t+=" ("+i.length+")"),(console.group!==n||console.table!==n)&&s.length>0&&(console.groupCollapsed(t),console.table?console.table(s):e.each(s,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),s=[]}},invoke:function(t,a,i){var r,u,s,l=W;return a=a||d,i=F||i,"string"==typeof t&&l!==n&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(a,o){var i=a!=r?o+t[a+1].charAt(0).toUpperCase()+t[a+1].slice(1):t;if(e.isPlainObject(l[i])&&a!=r)l=l[i];else{if(l[i]!==n)return u=l[i],!1;if(!e.isPlainObject(l[o])||a==r)return l[o]!==n?(u=l[o],!1):(p.error(t),!1);l=l[o]}})),e.isFunction(u)?s=u.apply(i,a):u!==n&&(s=u),e.isArray(o)?o.push(s):o!==n?o=[o,s]:s!==n&&(o=s),u}},c?(W===n&&p.initialize(),p.invoke(l)):(W!==n&&W.invoke("destroy"),p.initialize())}),o!==n?o:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!1,performance:!1,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",seekButton:".seek.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeChangeButton:".volume.push.button",volumeProgress:".volume.progress",muteButton:".mute.button",rateInput:'.rate input[type="number"]',rateReset:".rate .reset",loaderDimmer:".load.dimmer",readyStateRadio:'.ready.state input[type="radio"]',networkStateRadio:'.network.state input[type="radio"]',timeLookupValue:".timelookup .time",timeLookupBuffer:'.timelookup .buffer.checkbox input[type="checkbox"]',timeLookupPlayed:'.timelookup .played.checkbox input[type="checkbox"]',sourcePicker:".source.picker",statesLabel:".ready.state label, .network.state label, .timelookup .buffer.checkbox label, .timelookup .played.checkbox label"},matadata:{volumeStep:"volume-step",seekStep:"seek-step"},constants:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4,NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3},seekedDelay:250,timeResetText:"0:00:00",onTimeLookupStart:function(){},onTimeLookupStop:function(){},onReset:function(){}}}(jQuery,window,document);