/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,a){"use strict";function o(e,t,n){return t<=e.length?e:o(t,n+e,n)}function u(e,t){for(var n=0;n<t.length;n++)if(e>=t.start(n)&&e<=t.end(n))return!0;return!1}function i(e){var t=new Date(1e3*e),n=o(String(t.getHours()-1),1,"0")+":"+o(String(t.getMinutes()),2,"0")+":"+o(String(t.getSeconds()),2,"0");return n}e.fn.video=function(n){{var o,s=e(this),r=s.selector||"",c=(new Date).getTime(),l=[],d=arguments[0],p="string"==typeof d,m=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return s.each(function(){var g,f=e.isPlainObject(n)?e.extend(!0,{},e.fn.video.settings,n):e.extend({},e.fn.video.settings),b=(f.selector,f.className,f.error,f.metadata,f.namespace),k=(f.templates,"."+b),v="module-"+b,y=(e(t),e(this)),R=y.find(f.selector.video),T=y.find(f.selector.playButton),h=y.find(f.selector.seekButton),A=y.find(f.selector.currentTime),E=y.find(f.selector.remainingTime),N=y.find(f.selector.timeRange),S=y.find(f.selector.volumeUpButton),q=y.find(f.selector.volumeDownButton),_=y.find(f.selector.volumeProgress),O=y.find(f.selector.muteButton),U=y.find(f.selector.rateInput),D=y.find(f.selector.rateReset),w=y.find(f.selector.readyStateRadio),x=y.find(f.selector.networkStateRadio),C=y.find(f.selector.statesLabel),H=y.find(f.selector.bufferCheckbox),G=y.find(f.selector.seekableCheckbox),V=y.find(f.selector.playedCheckbox),I=y.find(f.selector.seekingStateCheckbox),B=y.find(f.selector.seekingStateDimmer).dimmer({duration:{hide:1e3}}),P=!0,L=N.prop("max")-N.prop("min"),F=t.setTimeout(1,function(){}),K=a,W=!1,M=t.setTimeout(1,function(){}),j=this,z=R.get(0),Y=y.data(v);g={initialize:function(){g.debug("Initializing video"),g.instantiate(),g.bind.events(),g.initialValues()},instantiate:function(){g.verbose("Storing instance of module",g),Y=g,y.data(v,g)},bind:{events:function(){g.debug("Binding video module events"),R.on("play"+k+" playing"+k+" pause"+k+" ended"+k,g.update.playState).on("ratechange"+k,g.update.rate).on("timeupdate"+k,g.update.time).on("seeking"+k,g.update.seeking).on("seeked"+k,g.update.seeked).on("volumechange"+k,g.update.volume).on("canplaythrough"+k+" canplay"+k+" loadeddata"+k+" loadedmetadata"+k+" emptied"+k+" waiting"+k,g.update.readyState).on("error"+k+" loadstart"+k+" emptied"+k+" stalled"+k+" suspend"+k+" waiting"+k+" loadedmetadata"+k+" loadeddata"+k,g.update.networkState),T.on("click"+k,g.request.playToggle),h.on("mousedown"+k,g.request.seek.tickLoop).on("mouseup"+k+"mouseleave"+k+"mouseout"+k+"click"+k,g.request.seek.stopLoop),N.on("change"+k,g.request.seek.fromRangeValue).on("mousedown"+k,g.deactivate.timeRangeUpdate).on("mouseup"+k,g.activate.timeRangeUpdate),S.on("click"+k,g.request.volumeUp),q.on("click"+k,g.request.volumeDown),_.on("click"+k,g.request.unmute),O.on("click"+k,g.request.muteToggle),U.on("change"+k,g.request.rate),D.on("click"+k,g.reset.rate),w.on("click"+k,g.request.denied),x.on("click"+k,g.request.denied),C.on("click"+k,g.request.denied)}},initialValues:function(){g.update.playState(),g.update.volume()},get:{pausedState:function(){return g.debug("Get paused state"),R.prop("paused")},endedState:function(){return g.debug("Get ended state"),R.prop("ended")},currentTime:function(){return g.debug("Get current time value"),R.prop("currentTime")},duration:function(){return g.debug("Get duration value"),R.prop("duration")},bufferedRanges:function(){return g.debug("Get buffered ranges"),R.prop("buffered")},seekableRanges:function(){return g.debug("Get seekable ranges"),R.prop("seekable")},playedRanges:function(){return g.debug("Get played ranges"),R.prop("played")},volume:function(){return g.debug("Get volume value"),R.prop("volume")},playbackRate:function(){return g.debug("Get playback rate value"),R.prop("playbackRate")},readyState:function(){switch(g.debug("Get ready state value"),R.prop("readyState")){default:case y.prop("HAVE_NOTHING"):return f.constants.HAVE_NOTHING;case R.prop("HAVE_METADATA"):return f.constants.HAVE_METADATA;case R.prop("HAVE_CURRENT_DATA"):return f.constants.HAVE_CURRENT_DATA;case R.prop("HAVE_FUTURE_DATA"):return f.constants.HAVE_FUTURE_DATA;case R.prop("HAVE_ENOUGH_DATA"):return f.constants.HAVE_ENOUGH_DATA}},networkState:function(){switch(g.debug("Get network state value"),y.prop("neworkState")){default:case y.prop("NETWORK_EMPTY"):return f.constants.NETWORK_EMPTY;case R.prop("NETWORK_IDLE"):return f.constants.NETWORK_IDLE;case R.prop("NETWORK_LOADING"):return f.constants.NETWORK_LOADING;case R.prop("NETWORK_NO_SOURCE"):return f.constants.NETWORK_NO_SOURCE}}},is:{playing:function(){return g.debug("Is playing"),!g.get.pausedState()&&!g.get.endedState()},seeking:function(){return g.debug("Is seeking"),R.prop("seeking")},muted:function(){return g.debug("Is muted"),R.prop("muted")},timeBuffered:function(e){return g.debug("Is timeBuffered"),u(e,g.get.bufferedRanges())},timePlayed:function(e){return g.debug("Is timePlayed"),u(e,g.get.playedRanges())},timeSeekable:function(e){return g.debug("Is timeSeekable"),u(e,g.get.seekableRanges())}},update:{playState:function(){g.debug("Update play state"),g.is.playing()?T.addClass(f.className.active):T.removeClass(f.className.active)},time:function(){var e=g.get.currentTime(),t=g.get.duration();g.debug("Update time"),A.text(i(e)),E.text(i(t-e)),P&&N.val(L*e/t),H.prop("checked",g.is.timeBuffered(e)),G.prop("checked",g.is.timeSeekable(e)),V.prop("checked",g.is.timePlayed(e))},seeking:function(){g.debug("Update seek state (seeking)"),t.clearTimeout(M),I.prop("checked",!0),B.dimmer("show")},seeked:function(){g.debug("Update seek state (seeked)"),W||g.is.seeking()||(I.prop("checked",!1),B.dimmer("hide"))},volume:function(){var e=g.is.muted(),t=g.get.volume();g.debug("Update volume and mute states"),e?(S.addClass(f.className.disabled),q.addClass(f.className.disabled),_.addClass(f.className.disabled),O.addClass(f.className.active)):(S.removeClass(f.className.disabled),q.removeClass(f.className.disabled),_.removeClass(f.className.disabled),O.removeClass(f.className.active)),_.progress({percent:100*t})},rate:function(){g.debug("Update playBack rate"),U.val(g.get.playbackRate())},readyState:function(){g.debug("Update ready state"),w.filter("[value="+g.get.readyState()+"]").prop("checked",!0)},networkState:function(){g.debug("Update network state"),x.filter("[value="+g.get.networkState()+"]").prop("checked",!0)}},request:{play:function(){g.debug("Request play"),z.play()},pause:function(){g.debug("Request pause"),z.pause()},playToggle:function(){g.debug("Request play toggle"),g.is.playing()?z.pause():z.play()},rate:function(){g.debug("Request playback rate (from button data)"),z.playbackRate=parseFloat(e(this).val())},seek:{toAbsoluteTime:function(e){g.debug("Request time absolute seek"),z.fastSeek?z.fastSeek(e):z.currentTime=e},toRelativeTime:function(){g.debug("Request time relative seek from current position)");var t=g.get.currentTime()+e(this).data("seek-step");g.request.seek.toAbsoluteTime(t)},fromRangeValue:function(){g.debug("Request time seek from absolute range value");var e=N.val()/L,t=g.get.duration()*e;g.request.seek.toAbsoluteTime(t)},tickLoop:function(){g.debug("Tick seek loop"),t.clearTimeout(F),K===a?(K=g.is.playing(),g.request.pause()):(W=!0,g.request.seek.toRelativeTime.bind(this)()),F=t.setTimeout(g.request.seek.tickLoop.bind(this),parseInt(e(this).data("seek-interval")))},stopLoop:function(){g.debug("Stop seek loop"),t.clearTimeout(F),K&&g.request.play(),K=a,W||g.request.seek.toRelativeTime.bind(this)(),W=!1,g.update.seeked()}},volumeUp:function(){z.muted?g.request.unmute():(g.debug("Request volume up"),z.volume=Math.min(z.volume+f.volumeStep,1))},volumeDown:function(){z.muted?g.request.unmute():(g.debug("Request volume down"),z.volume=Math.max(z.volume-f.volumeStep,0))},mute:function(){g.debug("Request mute"),z.muted=!0},unmute:function(){g.debug("Request unmute"),z.muted=!1},muteToggle:function(){g.debug("Request mute toggle"),z.muted=!z.muted},denied:function(e){g.debug("Requet denied"),e.preventDefault()}},activate:{timeRangeUpdate:function(){g.debug("Activate timeRange autoupdate"),P=!0}},deactivate:{timeRangeUpdate:function(){g.debug("Deactivate timeRange autoupdate"),P=!1}},reset:{rate:function(){g.debug("Reset playBack rate"),z.playbackRate=z.defaultPlaybackRate},all:function(){g.debug("Clearing video"),f.onReset()}},destroy:function(){g.verbose("Destroying previous instance of video"),R=null,g.reset(),y.removeData(v).off(k)},refresh:function(){g.verbose("Refreshing selector cache"),R=j},setting:function(t,n){if(g.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,f,t);else{if(n===a)return f[t];f[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,g,t);else{if(n===a)return g[t];g[t]=n}},debug:function(){f.debug&&(f.performance?g.performance.log(arguments):(g.debug=Function.prototype.bind.call(console.info,console,f.name+":"),g.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?g.performance.log(arguments):(g.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),g.verbose.apply(console,arguments)))},error:function(){g.error=Function.prototype.bind.call(console.error,console,f.name+":"),g.error.apply(console,arguments)},performance:{log:function(e){var t,n,a;f.performance&&(t=(new Date).getTime(),a=c||t,n=t-a,c=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:j,"Execution Time":n})),clearTimeout(g.performance.timer),g.performance.timer=setTimeout(g.performance.display,500)},display:function(){var t=f.name+":",n=0;c=!1,clearTimeout(g.performance.timer),e.each(l,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",r&&(t+=" '"+r+"'"),s.length>1&&(t+=" ("+s.length+")"),(console.group!==a||console.table!==a)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]},invoke:function(t,n,u){var i,s,r,c=Y;return n=n||m,u=j||u,"string"==typeof t&&c!==a&&(t=t.split(/[\. ]/),i=t.length-1,e.each(t,function(n,o){var u=n!=i?o+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(c[u])&&n!=i)c=c[u];else{if(c[u]!==a)return s=c[u],!1;if(!e.isPlainObject(c[o])||n==i)return c[o]!==a?(s=c[o],!1):(g.error(t),!1);c=c[o]}})),e.isFunction(s)?r=s.apply(u,n):s!==a&&(r=s),e.isArray(o)?o.push(r):o!==a?o=[o,r]:r!==a&&(o=r),s}}},p?(Y===a&&g.initialize(),g.invoke(d)):(Y!==a&&Y.invoke("destroy"),g.initialize())}),o!==a?o:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!0,performance:!0,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",seekButton:".seek.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeUpButton:".volume.up.button",volumeDownButton:".volume.down.button",volumeProgress:".volume.progress",muteButton:".mute.button",rateInput:'.rate input[type="number"]',rateReset:".rate .reset",seekingStateCheckbox:'.seeking.checkbox input[type="checkbox"]',seekingStateDimmer:".seeking.dimmer",readyStateRadio:'.ready.state input[type="radio"]',networkStateRadio:'.network.state input[type="radio"]',bufferCheckbox:'.buffer.checkbox input[type="checkbox"]',seekableCheckbox:'.seekable.checkbox input[type="checkbox"]',playedCheckbox:'.played.checkbox input[type="checkbox"]',statesLabel:".ready.state label, .network.state label, .buffer.checkbox label, .seekable.checkbox label, .played.checkbox label"},constants:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4,NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3},volumeStep:.1}}(jQuery,window,document);