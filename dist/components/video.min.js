/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,a,n){"use strict";function o(e,t,a){return t<=e.length?e:o(t,a+e,a)}function i(e){var t=new Date(1e3*e),a=o(String(t.getHours()-1),1,"0")+":"+o(String(t.getMinutes()),2,"0")+":"+o(String(t.getSeconds()),2,"0");return a}e.fn.video=function(a){{var o,u=e(this),s=u.selector||"",r=(new Date).getTime(),l=[],c=arguments[0],d="string"==typeof c,m=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return u.each(function(){var p,g=e.isPlainObject(a)?e.extend(!0,{},e.fn.video.settings,a):e.extend({},e.fn.video.settings),f=(g.selector,g.className,g.error,g.metadata,g.namespace),v=(g.templates,"."+f),b="module-"+f,k=(e(t),e(this)),y=k.find(g.selector.video),R=k.find(g.selector.playButton),q=k.find(g.selector.seekButton),h=k.find(g.selector.currentTime),T=k.find(g.selector.remainingTime),S=k.find(g.selector.timeRange),w=k.find(g.selector.volumeUpButton),C=k.find(g.selector.volumeDownButton),N=k.find(g.selector.volumeProgress),B=k.find(g.selector.muteButton),U=k.find(g.selector.rateInput),x=k.find(g.selector.rateReset),A=k.find(g.selector.readyStateRadio),D=k.find(g.selector.networkStateRadio),F=!0,P=S.prop("max")-S.prop("min"),j=t.setTimeout(1,function(){}),z=n,E=this,L=y.get(0),O=k.data(b);p={initialize:function(){p.debug("Initializing video"),p.instantiate(),p.bind.events(),p.initialValues()},instantiate:function(){p.verbose("Storing instance of module",p),O=p,k.data(b,p)},bind:{events:function(){p.debug("Binding video module events"),y.on("play"+v+" playing"+v+" pause"+v+" ended"+v,p.update.playState).on("ratechange"+v,p.update.rate).on("timeupdate"+v,p.update.time).on("seeking"+v+" seeked"+v,p.update.seek).on("volumechange"+v,p.update.volume).on("canplaythrough"+v+" canplay"+v+" loadeddata"+v+" loadedmetadata"+v+" emptied"+v+" waiting"+v,p.update.readyState).on("error"+v+" loadstart"+v+" emptied"+v+" stalled"+v+" suspend"+v+" waiting"+v+" loadedmetadata"+v+" loadeddata"+v,p.update.networkState),R.on("click"+v,p.request.playToggle),q.on("click"+v,p.request.seek.toRelativeTime).on("mousedown"+v,p.request.seek.tickLoop).on("mouseup"+v+"mouseleave"+v,p.request.seek.stopLoop),S.on("change"+v,p.request.seek.fromRangeValue).on("mousedown"+v,p.deactivate.timeRangeUpdate).on("mouseup"+v,p.activate.timeRangeUpdate),w.on("click"+v,p.request.volumeUp),C.on("click"+v,p.request.volumeDown),N.on("click"+v,p.request.unmute),B.on("click"+v,p.request.muteToggle),U.on("change"+v,p.request.rate),x.on("click"+v,p.reset.rate)}},initialValues:function(){p.update.playState(),p.update.time(),p.update.volume()},request:{playToggle:function(){return p.debug("Request play toggle"),L.paused?p.request.play():p.request.pause()},play:function(){return p.debug("Request play"),L.play()},pause:function(){return p.debug("Request pause"),L.pause()},rate:function(){p.debug("Request playBack rate (from button data)"),L.playbackRate=parseFloat(e(this).val())},seek:{toAbsoluteTime:function(e){p.debug("Request time absolute seek"),L.fastSeek?L.fastSeek(e):L.currentTime=e},toRelativeTime:function(){p.debug("Request time relative seek from current position)");var t=L.currentTime+e(this).data("seek-step");p.request.seek.toAbsoluteTime(t)},fromRangeValue:function(){p.debug("Request time seek from absolute range value");var e=S.val()/P,t=L.duration*e;p.request.seek.toAbsoluteTime(t)},tickLoop:function(){p.debug("Tick seek loop"),t.clearTimeout(j),z===n?(z=!L.paused,p.request.pause()):p.request.seek.toRelativeTime.bind(this)(),j=t.setTimeout(p.request.seek.tickLoop.bind(this),parseInt(e(this).data("seek-interval")))},stopLoop:function(){p.debug("Stop seek loop"),t.clearTimeout(j),z&&p.request.play(),z=n}},volumeUp:function(){L.muted?p.request.unmute():(p.debug("Request volume up"),L.volume=Math.min(L.volume+g.volumeStep,1))},volumeDown:function(){L.muted?p.request.unmute():(p.debug("Request volume down"),L.volume=Math.max(L.volume-g.volumeStep,0))},mute:function(){p.debug("Request mute"),L.muted=!0},unmute:function(){p.debug("Request unmute"),L.muted=!1},muteToggle:function(){p.debug("Request mute toggle"),L.muted=!L.muted}},reset:{rate:function(){p.debug("Reset playBack rate"),L.playbackRate=L.defaultPlaybackRate},all:function(){p.debug("Clearing video"),g.onReset()}},update:{playState:function(){p.debug("Update play state"),L.paused?R.removeClass(g.className.active):R.addClass(g.className.active)},time:function(){p.debug("Update time"),h.text(i(L.currentTime)),T.text(i(L.duration-L.currentTime)),F&&S.val(P*L.currentTime/L.duration)},seek:function(){p.debug("Update seek state"),L.seeking?S.prop("disabled",!0).addClass(g.className.disabled):S.prop("disabled",!1).removeClass(g.className.disabled)},volume:function(){p.debug("Update volume and mute states"),L.muted?(w.addClass(g.className.disabled),C.addClass(g.className.disabled),N.addClass(g.className.disabled),B.addClass(g.className.active)):(w.removeClass(g.className.disabled),C.removeClass(g.className.disabled),N.removeClass(g.className.disabled),B.removeClass(g.className.active)),N.progress({percent:100*L.volume})},rate:function(){p.debug("Update playBack rate"),U.val(L.playbackRate)},readyState:function(){A.filter("[value="+L.readyState+"]").prop("checked",!0)},networkState:function(){D.filter("[value="+L.networkState+"]").prop("checked",!0)}},activate:{timeRangeUpdate:function(){p.debug("Activate timeRange autoupdate"),F=!0}},deactivate:{timeRangeUpdate:function(){p.debug("Deactivate timeRange autoupdate"),F=!1}},destroy:function(){p.verbose("Destroying previous instance of video"),y=null,p.reset(),k.removeData(b).off(v)},refresh:function(){p.verbose("Refreshing selector cache"),y=E},setting:function(t,a){if(p.debug("Changing setting",t,a),e.isPlainObject(t))e.extend(!0,g,t);else{if(a===n)return g[t];g[t]=a}},internal:function(t,a){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(a===n)return p[t];p[t]=a}},debug:function(){g.debug&&(g.performance?p.performance.log(arguments):(p.debug=Function.prototype.bind.call(console.info,console,g.name+":"),p.debug.apply(console,arguments)))},verbose:function(){g.verbose&&g.debug&&(g.performance?p.performance.log(arguments):(p.verbose=Function.prototype.bind.call(console.info,console,g.name+":"),p.verbose.apply(console,arguments)))},error:function(){p.error=Function.prototype.bind.call(console.error,console,g.name+":"),p.error.apply(console,arguments)},performance:{log:function(e){var t,a,n;g.performance&&(t=(new Date).getTime(),n=r||t,a=t-n,r=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:E,"Execution Time":a})),clearTimeout(p.performance.timer),p.performance.timer=setTimeout(p.performance.display,500)},display:function(){var t=g.name+":",a=0;r=!1,clearTimeout(p.performance.timer),e.each(l,function(e,t){a+=t["Execution Time"]}),t+=" "+a+"ms",s&&(t+=" '"+s+"'"),u.length>1&&(t+=" ("+u.length+")"),(console.group!==n||console.table!==n)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,a,i){var u,s,r,l=O;return a=a||m,i=E||i,"string"==typeof t&&l!==n&&(t=t.split(/[\. ]/),u=t.length-1,e.each(t,function(a,o){var i=a!=u?o+t[a+1].charAt(0).toUpperCase()+t[a+1].slice(1):t;if(e.isPlainObject(l[i])&&a!=u)l=l[i];else{if(l[i]!==n)return s=l[i],!1;if(!e.isPlainObject(l[o])||a==u)return l[o]!==n?(s=l[o],!1):(p.error(t),!1);l=l[o]}})),e.isFunction(s)?r=s.apply(i,a):s!==n&&(r=s),e.isArray(o)?o.push(r):o!==n?o=[o,r]:r!==n&&(o=r),s}},d?(O===n&&p.initialize(),p.invoke(c)):(O!==n&&O.invoke("destroy"),p.initialize())}),o!==n?o:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!0,performance:!0,className:{active:"active",disabled:"disabled"},selector:{video:"video",playButton:".play.button",seekButton:".seek.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeUpButton:".volume.up.button",volumeDownButton:".volume.down.button",volumeProgress:".volume.progress",muteButton:".mute.button",rateInput:'.rate input[type="number"]',rateReset:".rate .reset",readyStateRadio:'.ready.state input[type="radio"]',networkStateRadio:'.network.state input[type="radio"]'},volumeStep:.1}}(jQuery,window,document);