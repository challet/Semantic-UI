/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributorss
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,a,o){"use strict";e.fn.video=function(a){{var n,i=e(this),u=i.selector||"",r=(new Date).getTime(),s=[],l=arguments[0],c="string"==typeof l,p=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)}}return i.each(function(){var d,m=e.isPlainObject(a)?e.extend(!0,{},e.fn.video.settings,a):e.extend({},e.fn.video.settings),f=(m.selector,m.className,m.error,m.metadata,m.namespace),g=(m.templates,"."+f),b="module-"+f,k=(e(t),e(this)),v=k.find(m.selector.video),y=k.find(m.selector.playButton),h=k.find(m.selector.seekButton),T=k.find(m.selector.currentTime),R=k.find(m.selector.remainingTime),A=k.find(m.selector.timeRange),q=k.find(m.selector.volumeChangeButton),E=k.find(m.selector.volumeProgress),S=k.find(m.selector.muteButton),N=k.find(m.selector.rateInput),_=k.find(m.selector.rateReset),x=k.find(m.selector.readyStateRadio),C=k.find(m.selector.networkStateRadio),O=k.find(m.selector.statesLabel),D=k.find(m.selector.timeLookupBuffer),w=k.find(m.selector.timeLookupPlayed),L=(k.find(m.selector.seekingStateCheckbox),k.find(m.selector.loaderDimmer)),V=k.find(m.selector.timeLookupValue),U=k.find(m.selector.sourcePicker),H=k.find(m.selector.fullScreenButton),F=k.find(m.selector.autoplayCheckbox),P=k.find(m.selector.loopCheckbox),I=k.find(m.selector.preloadCheckbox),B=y.add(h),K=t.setTimeout(function(){},1),W=!1,G=A.prop("max")-A.prop("min"),M=null,z=!1,j=o,Y=this,Q=v.get(0),J=k.data(b);d={initialize:function(){d.debug("Initializing video"),d.instantiate(),d.bind.events(),d.initialValues()},instantiate:function(){d.verbose("Storing instance of module",d),J=d,k.data(b,d)},bind:{events:function(){d.debug("Binding video module events"),v.on("play"+g+" playing"+g+" pause"+g+" ended"+g+" emptied"+g,d.update.playState).on("canplaythrough"+g+" canplay"+g+" loadeddata"+g+" emptied"+g+" waiting"+g,d.update.readyState).on("error"+g+" canplay"+g+" canplaythrough"+g+" loadstart"+g+" loadedmetadata"+g+" loadeddata"+g+" stalled"+g+" suspend"+g+" emptied"+g+" waiting"+g,d.update.networkState).on("ratechange"+g,d.update.rate).on("timeupdate"+g+" loadedmetadata"+g,d.update.time).on("seeking"+g+" waiting"+g+" emptied"+g+" stalled"+g,d.activate.loader).on("seeked"+g+" canplay"+g+" canplaythrough"+g,d.deactivate.loader).on("volumechange"+g,d.update.volume).on("emptied"+g+" stalled"+g,d.deactivate.playable).on("suspend"+g,d.activate.playable),h.on("mousedown"+g,d.request.seek.loop.tick).on("mouseup"+g+" mouseleave"+g,d.request.seek.loop.stop).on("click"+g,d.request.seek.loop.filterClick),y.on("click"+g,d.request.playToggle),A.on("mousedown"+g,d.activate.timeLookup).on("mouseup"+g,d.deactivate.timeLookup).on("input"+g,d.update.timeLookup).on("change"+g,d.request.seek.fromRangeValue),q.on("click"+g,d.request.volume.shift),E.on("click"+g,d.request.unmute),S.on("click"+g,d.request.muteToggle),N.on("change"+g,d.request.rate),_.on("click"+g,d.reset.rate),x.on("click"+g,d.request["void"]),C.on("click"+g,d.request["void"]),O.on("click"+g,d.request["void"]),U.on("change"+g,d.request.source),H.on("click"+g,d.request.fullScreen),F.on("change"+g,d.request.autoplay),P.on("change"+g,d.request.loop),I.on("change"+g,d.request.preload)}},initialValues:function(){d.deactivate.playable()},get:{pausedState:function(){return v.prop("paused")},endedState:function(){return v.prop("ended")},currentTime:function(){return v.prop("currentTime")},duration:function(){return v.prop("duration")},bufferedRanges:function(){return v.prop("buffered")},seekableRanges:function(){return v.prop("seekable")},playedRanges:function(){return v.prop("played")},volume:function(){return v.prop("volume")},playbackRate:function(){return v.prop("playbackRate")},readyState:function(){var e;switch(v.prop("readyState")){default:case v.prop("HAVE_NOTHING"):e=m.constants.HAVE_NOTHING;break;case v.prop("HAVE_METADATA"):e=m.constants.HAVE_METADATA;break;case v.prop("HAVE_CURRENT_DATA"):e=m.constants.HAVE_CURRENT_DATA;break;case v.prop("HAVE_FUTURE_DATA"):e=m.constants.HAVE_FUTURE_DATA;break;case v.prop("HAVE_ENOUGH_DATA"):e=m.constants.HAVE_ENOUGH_DATA}return e},networkState:function(){var e;switch(v.prop("networkState")){default:case v.prop("NETWORK_EMPTY"):e=m.constants.NETWORK_EMPTY;break;case v.prop("NETWORK_IDLE"):e=m.constants.NETWORK_IDLE;break;case v.prop("NETWORK_LOADING"):e=m.constants.NETWORK_LOADING;break;case v.prop("NETWORK_NO_SOURCE"):e=m.constants.NETWORK_NO_SOURCE}return e},timeRangeValue:function(){return d.get.duration()*A.val()/G},readableTime:function(e){var t=function(e,a,o){return a<=e.length?e:t(a,o+e,o)},a=new Date(1e3*e),o=t(String(a.getHours()-1),1,"0")+":"+t(String(a.getMinutes()),2,"0")+":"+t(String(a.getSeconds()),2,"0");return o}},is:{playing:function(){return!d.get.pausedState()&&!d.get.endedState()},seeking:function(){return v.prop("seeking")},muted:function(){return v.prop("muted")},timeBuffered:function(e){return d.is.timeInRange(e,d.get.bufferedRanges())},timePlayed:function(e){return d.is.timeInRange(e,d.get.playedRanges())},timeSeekable:function(e){return d.is.timeInRange(e,d.get.seekableRanges())},timeInRange:function(e,t){for(var a=0;a<t.length;a++)if(e>=t.start(a)&&e<=t.end(a))return!0;return!1},formatSupported:function(e){var t;switch(Q.canPlayType(e)){case"probably":case"maybe":t=!0;break;default:t=!1}return t}},update:{playState:function(){var e=d.is.playing();d.debug("Update play state",e),e?y.addClass(m.className.active):y.removeClass(m.className.active)},time:function(){var e=d.get.currentTime(),t=d.get.duration();isNaN(t)?d.reset.time():(d.debug("Update time",e),T.text(d.get.readableTime(e)),R.text(d.get.readableTime(t-e)),W||A.val(G*e/t))},volume:function(){var e=d.is.muted(),t=d.get.volume();d.debug("Update volume and mute states",t,e),e?(q.addClass(m.className.disabled),E.addClass(m.className.disabled),S.addClass(m.className.active)):(q.removeClass(m.className.disabled),E.removeClass(m.className.disabled),S.removeClass(m.className.active)),E.progress({percent:100*t})},rate:function(){var e=d.get.playbackRate();d.debug("Update playBack rate",e),N.val(e)},readyState:function(){var e=d.get.readyState();d.debug("Update ready state",e),x.filter("[value="+e+"]").prop("checked",!0)},networkState:function(){var e=d.get.networkState();d.debug("Update network state",e),C.filter("[value="+e+"]").prop("checked",!0)},timeLookup:function(e){var t=d.get.timeRangeValue();d.debug("Update timelookup state",t),D.prop("checked",d.is.timeBuffered(t)),w.prop("checked",d.is.timePlayed(t)),V.text(d.get.readableTime(t))}},request:{play:function(){d.debug("Request play"),Q.play()},pause:function(){d.debug("Request pause"),Q.pause()},playToggle:function(){d.is.playing()?Q.pause():Q.play()},rate:function(t){"number"!=typeof t&&(t=parseFloat(e(this).val())),d.debug("Request playback rate",t),Q.playbackRate=t},seek:{toAbsoluteTime:function(e){d.is.timeSeekable(e)?(d.debug("Request seek",e),Q.fastSeek?Q.fastSeek(e):Q.currentTime=e):d.debug("Time out of seekable ranges",e)},toRelativeTime:function(t){"number"!=typeof t&&(t=parseFloat(e(this).data(m.metadata.seekStep)));var a=d.get.currentTime()+t;d.request.seek.toAbsoluteTime(a)},fromRangeValue:function(){d.request.seek.toAbsoluteTime(d.get.timeRangeValue())},loop:{tick:function(a){null==M?(d.debug("seek loop starts"),d.activate.holdPlayState()):(z=!0,e(this).click()),M=t.setTimeout(d.request.seek.loop.tick.bind(this),parseInt(e(this).data(m.metadata.seekLoopInterval)))},stop:function(a){null!==M&&(z||e(this).click(),d.debug("seek loop stops"),t.clearTimeout(M),M=null,z=!1,d.deactivate.holdPlayState())},filterClick:function(e){typeof e.isTrigger!=o&&d.is.timeBuffered(d.get.currentTime())&&(d.update.time(),d.request.seek.toRelativeTime.call(this))}}},volume:{value:function(e){d.debug("Request volume value",e),e=Math.min(e,1),e=Math.max(e,0),Q.volume=e},shift:function(t){"number"!=typeof t&&(t=parseFloat(e(this).data(m.metadata.volumeStep))),d.request.volume.value(d.get.volume()+t)}},mute:function(){d.debug("Request mute"),Q.muted=!0},unmute:function(){d.debug("Request unmute"),Q.muted=!1},muteToggle:function(){d.is.muted()?d.request.unmute():d.request.mute()},"void":function(t){t.preventDefault(),e(this).blur()},source:function(a,o){"string"!=typeof a&&(a=e(this).dropdown("get value")),"string"!=typeof o&&(o=e(this).find('select option[value="'+a+'"]').data(m.metadata.videoType)),d.is.formatSupported(o)?(d.debug("Request source",a),v.empty().append(e("<source>",{src:a,type:o})),t.setTimeout(Q.load.bind(Q),1)):d.error("Request unsupported type",o,a)},fullScreen:function(){d.debug("Request full screen"),Q.requestFullscreen?Q.requestFullscreen():Q.msRequestFullscreen?Q.msRequestFullscreen():Q.mozRequestFullScreen?Q.mozRequestFullScreen():Q.webkitRequestFullscreen&&Q.webkitRequestFullscreen()},loop:function(t){"boolean"!=typeof t&&(t=e(this).prop("checked")),d.debug("Request loop",t),v.prop("loop",t)},preload:function(t){"boolean"!=typeof t&&(t=e(this).prop("checked")),d.debug("Request preload",t),v.prop("preload",t)},autoplay:function(t){"boolean"!=typeof t&&(t=e(this).prop("checked")),d.debug("Request autoplay",t),v.prop("autoplay",t)}},activate:{holdPlayState:function(){j=d.is.playing(),d.debug("Hold play state",j),d.request.pause()},timeLookup:function(){d.debug("Activate time lookup"),W=!0,m.onTimeLookupStart()},loader:function(){t.clearTimeout(K),L.dimmer("show")},playable:function(){B.hasClass(m.className.disabled)&&(d.debug("Activate playable mode"),d.update.time(),d.deactivate.loader(),B.removeClass(m.className.disabled),d.request.seek.toAbsoluteTime(0))}},deactivate:{holdPlayState:function(){d.debug("Unhold play state",j),j&&d.request.play(),j=o},timeLookup:function(){d.debug("Deactivate time lookup"),W=!1,m.onTimeLookupStop()},loader:function(e){e!==o?K=t.setTimeout(d.deactivate.loader,m.seekedDelay):L.dimmer("hide")},playable:function(){d.debug("Deactivate playable mode"),d.reset.time(),B.addClass(m.className.disabled)}},reset:{rate:function(){var e=Q.defaultPlaybackRate;d.debug("Reset playBack rate",e),Q.playbackRate=e},source:function(){d.debug("Reset (empty) source"),v.empty(),t.setTimeout(Q.load.bind(Q),1)},time:function(){d.debug("Reset time"),T.add(R).text(m.timeResetText)},all:function(){d.debug("Clearing video"),m.onReset()}},destroy:function(){d.verbose("Destroying previous instance of video"),v=null,d.reset.all(),k.removeData(b).off(g)},refresh:function(){d.verbose("Refreshing selector cache"),v=Y},setting:function(t,a){if(d.debug("Changing setting",t,a),e.isPlainObject(t))e.extend(!0,m,t);else{if(a===o)return m[t];m[t]=a}},internal:function(t,a){if(e.isPlainObject(t))e.extend(!0,d,t);else{if(a===o)return d[t];d[t]=a}},debug:function(){m.debug&&(m.performance?d.performance.log(arguments):(d.debug=Function.prototype.bind.call(console.info,console,m.name+":"),d.debug.apply(console,arguments)))},verbose:function(){m.verbose&&m.debug&&(m.performance?d.performance.log(arguments):(d.verbose=Function.prototype.bind.call(console.info,console,m.name+":"),d.verbose.apply(console,arguments)))},error:function(){d.error=Function.prototype.bind.call(console.error,console,m.name+":"),d.error.apply(console,arguments)},performance:{log:function(e){var t,a,o;m.performance&&(t=(new Date).getTime(),o=r||t,a=t-o,r=t,s.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:Y,"Execution Time":a})),clearTimeout(d.performance.timer),d.performance.timer=setTimeout(d.performance.display,500)},display:function(){var t=m.name+":",a=0;r=!1,clearTimeout(d.performance.timer),e.each(s,function(e,t){a+=t["Execution Time"]}),t+=" "+a+"ms",u&&(t+=" '"+u+"'"),i.length>1&&(t+=" ("+i.length+")"),(console.group!==o||console.table!==o)&&s.length>0&&(console.groupCollapsed(t),console.table?console.table(s):e.each(s,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),s=[]}},invoke:function(t,a,i){var u,r,s,l=J;return a=a||p,i=Y||i,"string"==typeof t&&l!==o&&(t=t.split(/[\. ]/),u=t.length-1,e.each(t,function(a,n){var i=a!=u?n+t[a+1].charAt(0).toUpperCase()+t[a+1].slice(1):t;if(e.isPlainObject(l[i])&&a!=u)l=l[i];else{if(l[i]!==o)return r=l[i],!1;if(!e.isPlainObject(l[n])||a==u)return l[n]!==o?(r=l[n],!1):(d.error(t),!1);l=l[n]}})),e.isFunction(r)?s=r.apply(i,a):r!==o&&(s=r),e.isArray(n)?n.push(s):n!==o?n=[n,s]:s!==o&&(n=s),r}},c?(J===o&&d.initialize(),d.invoke(l)):(J!==o&&J.invoke("destroy"),d.initialize())}),n!==o?n:this},e.fn.video.settings={name:"Video",namespace:"video",debug:!0,verbose:!1,performance:!1,className:{active:"active",disabled:"disabled",loading:"loading"},selector:{video:"video",playButton:".play.button",seekButton:".seek.button",currentTime:".current.time",remainingTime:".remaining.time",timeRange:'input[type="range"].time',volumeChangeButton:".volume.push.button",volumeProgress:".volume.progress",muteButton:".mute.button",rateInput:'.rate input[type="number"]',rateReset:".rate .reset",loaderDimmer:".load.dimmer",readyStateRadio:'.ready.state input[type="radio"]',networkStateRadio:'.network.state input[type="radio"]',timeLookupValue:".timelookup .time",timeLookupBuffer:'.timelookup .buffer.checkbox input[type="checkbox"]',timeLookupPlayed:'.timelookup .played.checkbox input[type="checkbox"]',sourcePicker:".source.picker",fullScreenButton:".fullscreen.button",autoplayCheckbox:'.autoplay.checkbox input[type="checkbox"]',loopCheckbox:'.loop.checkbox input[type="checkbox"]',preloadCheckbox:'.preload.checkbox input[type="checkbox"]',statesLabel:".ready.state label, .network.state label, .timelookup .buffer.checkbox label, .timelookup .played.checkbox label"},metadata:{volumeStep:"volume-step",seekStep:"seek-step",seekLoopInterval:"push-interval",videoType:"video-type"},constants:{HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4,NETWORK_EMPTY:0,NETWORK_IDLE:1,NETWORK_LOADING:2,NETWORK_NO_SOURCE:3},seekedDelay:500,timeResetText:"0:00:00",onTimeLookupStart:function(){},onTimeLookupStop:function(){},onReset:function(){}}}(jQuery,window,document);